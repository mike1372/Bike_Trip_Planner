<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Showing elevation along a path</title>
    <style>
      html, body, #google-map {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
    </style>
    <script src="https://www.google.com/jsapi"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
    <script>
function cc(a){ console.log(a) }
var elevator;
var map;
var chart;
var polyline;

var chapel = new google.maps.LatLng(-37.843143, 144.994886);
var melbourne = new google.maps.LatLng(-37.814198, 144.963446);
// Load the Visualization API and the columnchart package.
google.load('visualization', '1', {packages: ['columnchart']});





function initialize() {
  var mapOptions = {
    zoom: 12,
    center: melbourne,
    mapTypeId: 'terrain'
  }
  map      = new google.maps.Map(document.getElementById('google-map'), mapOptions);
  elevator = new google.maps.ElevationService();
  drawPath();// Draw path, using Visualization API and Elevation service.



      var rendererOptions = {
        draggable: true,
        hideRouteList: true,
        polylineOptions: {
            strokeOpacity: 0
        }
    };
    // Initialize the directions renderer.
    directionsDisplay = new google.maps.DirectionsRenderer(rendererOptions);
    var mapCanvas = document.getElementById('google-map');
    var mapOptions = {
        center: melbourne,
        zoom: 13,
        mapTypeId: 'terrain'
    };
    // Create a google maps object.
    map = new google.maps.Map(mapCanvas, mapOptions);
    directionsDisplay.setMap(map);



}






function drawPath() {

  chart = new google.visualization.ColumnChart(document.getElementById('elevation_chart'));
  var path = [  melbourne, chapel];
  var pathRequest = { 'path':    path, 'samples': 10 }
  elevator.getElevationAlongPath(pathRequest, plotElevation);
}





function plotElevation(results, status) {
  if (status != google.maps.ElevationStatus.OK) {
    return;
  }
  var elevations    = results;
  var elevationPath = [];
  for (var i = 0; i < results.length; i++)
    elevationPath.push(elevations[i].location);
  var pathOptions   = {
    path:        elevationPath,
    strokeColor: '#0000CC',
    opacity:     0.4,
    map:         map
  }
  polyline = new google.maps.Polyline(pathOptions);

  var data = new google.visualization.DataTable();
  data.addColumn('string', 'Sample');
  data.addColumn('number', 'Elevation');
  for (var i = 0; i < results.length; i++) {
    data.addRow(['', elevations[i].elevation]);
  }

  document.getElementById('elevation_chart').style.display = 'block';
  chart.draw(data, {
    height: 150,
    legend: 'none',
    titleY: 'Elevation (m)'
  });
}//





google.maps.event.addDomListener(window, 'load', initialize);
// google.maps.geometry.encoding.decodePath(jibberish)







    google.maps.event.addListener(directionsDisplay, 'directions_changed', function() {
    var route = directionsDisplay.getDirections().routes[0];
        start = route.legs[0].start_location;
        end = route.legs[0].end_location;
        saveWaypoints();
        if (mousemarker != null) {
            mousemarker.setMap(null);
            mousemarker = null;
        }
        drawPath(route.overview_path);
    });




function calcRoute() {
    var request = {
        origin: start,
        destination: end,
        travelMode: google.maps.TravelMode[mode],
        waypoints: waypoints,
        avoidHighways: true,
    };
    directionsService.route(request, function(response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(response);}
    });
}


function drawPath(path) {

    var pathRequest = {
        'path': path,
        'samples': 512
    }
   elevator.getElevationAlongPath(pathRequest, plotElevation);
}
    </script>
  </head>
  <body>
    <div>
      <div id="google-map" style="height:250px;"></div>
      <div id="elevation_chart"></div>
    </div>
  </body>
</html>